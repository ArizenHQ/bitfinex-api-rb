#!/usr/bin/env ruby -Ilib

require 'bitfinex'

@ws = Bitfinex::Websocket::EMClient.new

@ws.on(:open) do |msg|
  @ws.send({event: 'subscribe', 
            pair: 'BTCUSD', 
            channel: 'book', 
            prec: 'P0', 
            len: '25'})
end

@ws.on(:message) do |msg|
  puts msg
end

@ws.run!
